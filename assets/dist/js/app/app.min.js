(function() {
  var app;

  app = angular.module('opendyslexic', []);

  app.controller('core', function($scope) {
    $scope.checkboxModel = {
      value: false,
      text: 'Off'
    };
    angular.element(document).ready(function() {
      console.log("ss");
      chrome.storage.sync.get({
        'enabled': 'enabled'
      }, function(items) {
        $scope.checkboxModel.value = items.enabled;
        if ($scope.checkboxModel.value === true) {
          $scope.checkboxModel.text = "On";
        } else {
          $scope.checkboxModel.text = "Off";
        }
      });
    });

    /**
     * Adds Saves the Optoins
     */
    $scope.openDyslexic = function() {
      chrome.storage.sync.set({
        enabled: $scope.checkboxModel.value
      }, function() {
        $scope.checkboxModel.value = $scope.checkboxModel.value;
        if ($scope.checkboxModel.value === true) {
          $scope.checkboxModel.text = "On";
        } else {
          $scope.checkboxModel.text = "Off";
        }
        $scope.reloadPage();
      });
    };
    return $scope.reloadPage = function() {
      chrome.tabs.getSelected(null, function(tab) {
        var code;
        code = 'window.location.reload();';
        chrome.tabs.executeScript(tab.id, {
          code: code
        });
      });
    };
  });

  return;

}).call(this);
